<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fee Payment Portal - MIFTHAHUL HUDA MADRASA</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/@phosphor-icons/web"></script>

</head>

<body>
    <header id="main-header">
        <nav class="container">
            <a href="index.html#hero" class="logo">MHMV 2026.</a>
            <ul class="nav-links">
                <li><a href="index.html#hero">Home</a></li>
                <li><a href="services.html">Services</a></li>
                <li class="dropdown">
                    <a href="gallery.html" class="dropdown-toggle">Gallery</a>
                    <ul class="dropdown-menu">
                        <li><a href="gallery.html?tab=photo">Photo Gallery</a></li>
                        <li><a href="gallery.html?tab=video">Video Gallery</a></li>
                    </ul>
                </li>
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" class="active">Student Zone</a>
                    <ul class="dropdown-menu">
                        <li><a href="creative.html" class="active">Fee Payment</a></li>
                        <li><a href="restored_pages/creative.html">Creative Submission</a></li>
                        <li><a href="creation_receipt.html">Approved Receipts</a></li>
                        <li><a href="creations.html">Creations</a></li>
                    </ul>
                </li>
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle">Result</a>
                    <ul class="dropdown-menu">
                        <li><a href="result.html">Exam Result (New)</a></li>
                        <li><a href="exam_result.html">Exam Result (Old)</a></li>
                    </ul>
                </li>
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle">News</a>
                    <ul class="dropdown-menu">
                        <li><a href="index.html#news">Latest Updates</a></li>
                        <li><a href="news.html">All News</a></li>
                    </ul>
                </li>
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle">Portal</a>
                    <ul class="dropdown-menu">
                        <li><a href="admin/">Portal</a></li>
                        <li class="admin-only" style="display: none;"><a href="admin/"
                                style="font-weight: 600; color: var(--primary-color);">Admin
                                Panel</a></li>
                    </ul>
                </li>
                <li><a href="index.html#contact" class="btn-secondary" style="padding: 8px 15px;">Contact</a></li>
            </ul>
            <button class="mobile-menu-btn" aria-label="Toggle navigation">
                <span class="bar"></span>
                <span class="bar"></span>
                <span class="bar"></span>
            </button>
        </nav>
    </header>

    <header class="creative-header">
        <h1 class="creative-title">üí≥ Fee Payment Portal</h1>
        <p>Submit Fee Receipt Proof & Track Payment Status</p>
        <a href="#creative" class="btn btn-primary" style="margin-top: 15px;">Book Tuition</a>
    </header>

    <!-- ================= STUDENT SUBMIT ================= -->
    <section id="creative">
        <div class="card creation-card submission-card animate-fade-up">
            <h2>üì§ Submit Fee Receipt Proof</h2>

            <div class="creative-input-group">
                <input id="name" placeholder="Student Name">
            </div>

            <!-- CLASS SELECTION -->
            <!-- CLASS SELECTION -->
            <div class="creative-input-group">
                <label style="display:block; margin-bottom:10px; color:#aaa;">Select Class</label>
                <div class="class-radio-grid">
                    <div class="class-radio"><input type="radio" name="cls" id="c1" value="1"><label for="c1">Class
                            1</label></div>
                    <div class="class-radio"><input type="radio" name="cls" id="c2" value="2"><label for="c2">Class
                            2</label></div>
                    <div class="class-radio"><input type="radio" name="cls" id="c3" value="3"><label for="c3">Class
                            3</label></div>
                    <div class="class-radio"><input type="radio" name="cls" id="c4" value="4"><label for="c4">Class
                            4</label></div>
                    <div class="class-radio"><input type="radio" name="cls" id="c5" value="5"><label for="c5">Class
                            5</label></div>
                    <div class="class-radio"><input type="radio" name="cls" id="c6" value="6"><label for="c6">Class
                            6</label></div>
                    <div class="class-radio"><input type="radio" name="cls" id="c7" value="7"><label for="c7">Class
                            7</label></div>
                    <div class="class-radio"><input type="radio" name="cls" id="c8" value="8"><label for="c8">Class
                            8</label></div>
                    <div class="class-radio"><input type="radio" name="cls" id="c9" value="9"><label for="c9">Class
                            9</label></div>
                    <div class="class-radio"><input type="radio" name="cls" id="c10" value="10"><label for="c10">Class
                            10</label></div>
                    <div class="class-radio"><input type="radio" name="cls" id="c11" value="11"><label for="c11">Class
                            11</label></div>
                    <div class="class-radio"><input type="radio" name="cls" id="c12" value="12"><label for="c12">Class
                            12</label></div>
                </div>
            </div>

            <div class="creative-input-group">
                <input id="receiptNo" type="number" placeholder="Receipt / Reference Number">
                <input id="payDate" type="date" placeholder="Payment Date">
            </div>

            <div class="creative-input-group">
                <textarea id="content" placeholder="Remarks / Payment Details (optional)" rows="3"></textarea>
            </div>

            <div class="file-upload-box">
                <label for="file"
                    style="display: block; color: var(--primary-color); font-size: 0.95rem; margin-bottom: 10px; font-weight: 600;">
                    <i class="ph ph-image"></i> Upload Receipt Image (Max 200KB)
                </label>
                <input type="file" id="file" accept="image/*"
                    style="padding: 0; background: transparent; border: none; margin: 0;"
                    onchange="validateFileSize(this)">
            </div>

            <script>
                function validateFileSize(input) {
                    const file = input.files[0];
                    if (file && file.size > 204800) { // 200KB in bytes
                        alert("File size exceeds 200KB. Please upload a smaller image.");
                        input.value = ""; // Clear the input
                    }
                }
            </script>

            <button onclick="submitWork()">Submit Receipt</button>
            <div id="status-msg" class="submission-status"></div>
        </div>
    </section>

    <!-- ================= ADMIN LOGIN ================= -->
    <section id="adminLoginSection">
        <div class="card admin animate-fade-up">
            <h2>üîê Admin Login</h2>
            <p style="color: #888; margin-bottom: 20px;">Only teachers can approve submissions.</p>
            <input id="adminEmail" placeholder="Email">
            <input id="adminPass" type="password" placeholder="Password">
            <button onclick="adminLogin()">Login to Dashboard</button>
        </div>
    </section>

    <!-- ================= ADMIN PANEL ================= -->
    <section id="adminPanel" class="hidden">
        <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 25px;">
            <h2>üõ† Fee Verification Panel</h2>
            <div style="display: flex; gap: 10px;">
                <a href="restored_pages/creative.html#adminLoginSection" class="btn-secondary"
                    style="padding: 10px 20px; text-decoration: none; font-size: 0.9rem;">Manage Creative
                    Submissions</a>
                <button onclick="logout()"
                    style="width: auto; padding: 10px 20px; margin: 0; background: #ff4444;">Logout</button>
            </div>
        </div>

        <div style="margin-bottom: 20px;">
            <select id="admin-class-filter" onchange="renderAdmin(this.value === 'all' ? null : this.value)"
                style="padding: 10px; border-radius: 8px; background: #222; color: #fff; border: 1px solid #444;">
                <option value="all">Filter by Class: All</option>
                <script>
                    for (let i = 1; i <= 12; i++) document.write(`<option value="${i}">Class ${i}</option>`);
                </script>
            </select>
        </div>

        <div class="grid" id="pending"></div>
    </section>

    <footer
        style="background: #0a0a0a; border-top: 1px solid var(--glass-border); padding: 60px 0 30px; margin-top: 80px;">
        <div class="container">
            <div
                style="display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 40px; margin-bottom: 40px;">
                <div>
                    <h3 style="color: var(--primary-color); margin-bottom: 20px; font-size: 1.3rem;">MIFTHAHUL HUDA
                        MADRASA</h3>
                    <p style="color: #888; line-height: 1.8;">Empowering students through quality education and Islamic
                        values at Vengara S S Road.</p>
                </div>
                <div>
                    <h4 style="color: #fff; margin-bottom: 20px;">Quick Links</h4>
                    <ul style="list-style: none; padding: 0;">
                        <li style="margin-bottom: 12px;"><a href="index.html#about"
                                style="color: #888; text-decoration: none; transition: 0.3s;"
                                onmouseover="this.style.color='var(--primary-color)'"
                                onmouseout="this.style.color='#888'">About Us</a></li>
                        <li style="margin-bottom: 12px;"><a href="index.html#booking"
                                style="color: #888; text-decoration: none; transition: 0.3s;"
                                onmouseover="this.style.color='var(--primary-color)'"
                                onmouseout="this.style.color='#888'">Book Tuition</a></li>
                        <li style="margin-bottom: 12px;"><a href="exam_result.html"
                                style="color: #888; text-decoration: none; transition: 0.3s;"
                                onmouseover="this.style.color='var(--primary-color)'"
                                onmouseout="this.style.color='#888'">Exam Results</a></li>
                        <li style="margin-bottom: 12px;"><a href="index.html#gallery"
                                style="color: #888; text-decoration: none; transition: 0.3s;"
                                onmouseover="this.style.color='var(--primary-color)'"
                                onmouseout="this.style.color='#888'">Gallery</a></li>
                    </ul>
                </div>
                <div>
                    <h4 style="color: #fff; margin-bottom: 20px;">Contact</h4>
                    <p style="color: #888; margin-bottom: 10px;">üìç Vengara S S Road</p>
                    <p style="color: #888; margin-bottom: 10px;">üìû <a href="https://wa.me/916235989198"
                            style="color: #888; text-decoration: none;">+91 6235989198</a></p>
                    <p style="color: #888;">‚úâÔ∏è Contact via WhatsApp</p>
                </div>
                <div>
                    <h4 style="color: #fff; margin-bottom: 20px;">Enroll Now</h4>
                    <p style="color: #888; margin-bottom: 20px; line-height: 1.6;">Start your learning journey with us
                        today!</p>
                    <a href="index.html#booking" class="btn btn-primary" style="display: inline-block;">Book a Tuition
                        Session</a>
                </div>
            </div>
            <div style="border-top: 1px solid rgba(255,255,255,0.1); padding-top: 30px; text-align: center;">
                <p style="color: #666; font-size: 0.9rem;">¬© 2026 MHMV. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <nav class="bottom-nav">
        <div class="bottom-nav-container">
            <a href="index.html#hero" class="nav-item">
                <i class="ph ph-house"></i>
                <span>Home</span>
            </a>
            <a href="gallery.html" class="nav-item">
                <i class="ph ph-image"></i>
                <span>Gallery</span>
            </a>

            <!-- CENTER ACTION BUTTON -->
            <a href="index.html#booking" class="btn-book-nav" aria-label="Book Tuition">
                <i class="ph-bold ph-calendar-plus" style="color: #000; font-size: 1.6rem;"></i>
            </a>

            <a href="creative.html" class="nav-item">
                <i class="ph ph-student"></i>
                <span>Student</span>
            </a>
            <a href="index.html#contact" class="nav-item">
                <i class="ph ph-chat-circle"></i>
                <span>Contact</span>
            </a>
        </div>
    </nav>

    <!-- WhatsApp Floating Button -->
    <div class="whatsapp-float-wrapper">
        <a href="https://wa.me/916235989198" class="whatsapp-btn" target="_blank" aria-label="Contact us on WhatsApp">
            <i class="ph-fill ph-whatsapp-logo"></i>
        </a>
    </div>

    <footer
        style="background: #0a0a0a; border-top: 1px solid var(--glass-border); padding: 80px 0 40px; margin-top: 60px;">
        <div class="container">
            <div
                style="display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 40px; margin-bottom: 50px;">
                <div>
                    <h3
                        style="color: var(--primary-color); margin-bottom: 25px; font-size: 1.4rem; letter-spacing: 1px;">
                        MIFTHAHUL HUDA</h3>
                    <p style="color: #666; line-height: 1.8;">Quality education and Islamic values at Vengara S S Road.
                        Empowering the next generation.</p>
                </div>
                <div>
                    <h4 style="color: #fff; margin-bottom: 25px;">Quick Links</h4>
                    <ul style="list-style: none; padding: 0;">
                        <li style="margin-bottom: 12px;"><a href="index.html#hero"
                                style="color: #888; transition: 0.3s;">Home</a></li>
                        <li style="margin-bottom: 12px;"><a href="result.html"
                                style="color: #888; transition: 0.3s;">Results</a></li>
                        <li style="margin-bottom: 12px;"><a href="creations.html"
                                style="color: #888; transition: 0.3s;">Creations</a></li>
                        <li style="margin-bottom: 12px;"><a href="admin/" style="color: #888; transition: 0.3s;">Admin
                                Access</a></li>
                    </ul>
                </div>
                <div>
                    <h4 style="color: #fff; margin-bottom: 25px;">Contact</h4>
                    <p style="color: #888; margin-bottom: 12px;">üìç Vengara S S Road</p>
                    <p style="color: #888;">üìû +91 6235989198</p>
                </div>
            </div>
            <div style="border-top: 1px solid rgba(255,255,255,0.05); padding-top: 30px; text-align: center;">
                <p style="color: #444; font-size: 0.85rem;">¬© 2026 MHMV. All rights reserved.</p>
                <a href="admin/"
                    style="color: #222; font-size: 0.7rem; text-decoration: none; margin-top: 10px; display: inline-block;">Platform
                    Administration</a>
            </div>
        </div>
    </footer>

    <script src="script.js"></script>
    <script>
        // ===== ADMIN CREDENTIALS =====
        const ADMIN_EMAIL = "123v213@gmail.com";
        const ADMIN_PASS = "@#asd123";

        // ===== STORAGE =====
        // Key is 'fee_receipts' to avoid conflict with old creative works, or user can clear local storage
        let works = JSON.parse(localStorage.getItem("fee_receipts") || "[]");

        // ===== SUBMIT =====
        function submitWork() {
            const nameEl = document.getElementById("name");
            const clsEn = document.querySelector('input[name="cls"]:checked');
            const receiptNoEl = document.getElementById("receiptNo");
            const payDateEl = document.getElementById("payDate");
            const contentEl = document.getElementById("content");
            const file = document.getElementById("file").files[0];
            const statusMsg = document.getElementById("status-msg");

            if (!nameEl.value || !clsEn || !receiptNoEl.value || !payDateEl.value || !file) {
                alert("Please fill in Name, Class, Receipt No, Date and upload an Image.");
                return;
            }

            const reader = new FileReader();

            reader.onload = () => {
                works.push({
                    name: nameEl.value,
                    cls: clsEn.value,
                    receiptNo: receiptNoEl.value,
                    date: payDateEl.value,
                    content: contentEl.value,
                    img: reader.result || "", // Base64 image
                    approved: false,
                    submittedAt: new Date().toLocaleString()
                });
                localStorage.setItem("fee_receipts", JSON.stringify(works));
                statusMsg.innerHTML = "‚úÖ Receipt Submitted! Waiting for verification.";
                statusMsg.style.color = "var(--primary-color)";

                // Reset form
                nameEl.value = "";
                document.querySelectorAll('input[name="cls"]').forEach(r => r.checked = false);
                receiptNoEl.value = "";
                payDateEl.value = "";
                contentEl.value = "";
                document.getElementById("file").value = "";

                setTimeout(() => {
                    location.reload();
                }, 2000);
            };

            if (file) reader.readAsDataURL(file);
            else {
                alert("Please upload a receipt image.");
            }
        }

        // ===== ADMIN LOGIN =====
        function adminLogin() {
            const email = document.getElementById("adminEmail").value;
            const pass = document.getElementById("adminPass").value;

            if (email === ADMIN_EMAIL && pass === ADMIN_PASS) {
                sessionStorage.setItem("admin", "true");
                window.location.href = "admin/dashboard.html";
            } else {
                alert("Wrong credentials");
            }
        }

        function logout() {
            sessionStorage.removeItem("admin");
            location.reload();
        }

        // ===== ADMIN VIEW =====
        function renderAdmin(filterClass = null) {
            const pending = document.getElementById("pending");
            pending.innerHTML = "";
            let count = 0;

            works.forEach((w, i) => {
                // Show if NOT approved AND matches filter (if any)
                // OR show ALL? User said "View submissions". Usually admin wants to see pending. 
                // Let's show all pending first.
                if (!w.approved && (!filterClass || w.cls == filterClass)) {
                    count++;
                    pending.innerHTML += `
                    <div class="card creation-card">
                        <span style="background: var(--primary-color); color: #000; padding: 5px 10px; border-radius: 5px; font-size: 0.8rem; font-weight: 700;">Class ${w.cls}</span>
                        <h4 style="margin: 15px 0 5px;">Receipt #${w.receiptNo}</h4>
                        <p style="color: #888; font-size: 0.9rem; margin-bottom: 5px;">${w.name}</p>
                        <p style="color: #666; font-size: 0.8rem; margin-bottom: 15px;">Date: ${w.date}</p>
                        ${w.img ? `<img src="${w.img}" onclick="window.open(this.src)" style="cursor:pointer; max-height: 200px; object-fit: contain;">` : ``}
                        <p style="font-size: 0.95rem; line-height: 1.5; color: #ccc; margin-top: 10px;">Remarks: ${w.content || 'None'}</p>
                        <div style="display: flex; gap: 10px; margin-top: 20px;">
                            <button onclick="approve(${i})" style="flex: 2; margin: 0;">Approve ‚úÖ</button>
                            <button onclick="reject(${i})" style="flex: 1; margin: 0; background: #333; color: #ff4444;">Reject üóëÔ∏è</button>
                        </div>
                    </div>`;
                }
            });

            if (count === 0) {
                pending.innerHTML = "<p style='grid-column: 1/-1; text-align: center; color: #666;'>No pending receipts found.</p>";
            }
        }

        // ===== APPROVE =====
        function approve(i) {
            works[i].approved = true;
            localStorage.setItem("fee_receipts", JSON.stringify(works));
            const clsFilter = document.getElementById('admin-class-filter')?.value || null;
            renderAdmin(clsFilter === "all" ? null : clsFilter);
            alert("Receipt Verified & Approved!");
        }

        // ===== REJECT/DELETE =====
        function reject(i) {
            if (confirm("Are you sure you want to reject/delete this receipt?")) {
                works.splice(i, 1);
                localStorage.setItem("fee_receipts", JSON.stringify(works));
                const clsFilter = document.getElementById('admin-class-filter')?.value || null;
                renderAdmin(clsFilter === "all" ? null : clsFilter);
            }
        }

        // ===== INIT =====
        if (sessionStorage.getItem("admin") === "true") {
            document.getElementById("adminPanel").classList.remove("hidden");
            document.getElementById("adminLoginSection").classList.add("hidden");
            renderAdmin();
        }
    </script>

    <script type="module" src="auth-nav-guard.js"></script>
</body>

</html>