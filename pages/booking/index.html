<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Book Tuition | MIFTHAHUL HUDA</title>

    <!-- Unified Assets -->
    <link rel="stylesheet" href="../../assets/css/main.css">
    <link href="https://fonts.googleapis.com/css2?family=Outfit:wght@300;400;600;700&display=swap" rel="stylesheet">
    <script src="https://unpkg.com/@phosphor-icons/web"></script>

    <style>
        .booking-hero {
            padding: 80px 0 40px;
            text-align: center;
        }

        .booking-card {
            max-width: 900px;
            margin: 0 auto 100px;
            padding: 50px;
        }

        .form-section-title {
            font-size: 1.2rem;
            font-weight: 700;
            color: #fff;
            margin-bottom: 25px;
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .form-row {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
            margin-bottom: 25px;
        }

        .checkbox-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(220px, 1fr));
            gap: 15px;
            background: rgba(255, 255, 255, 0.02);
            padding: 25px;
            border-radius: 20px;
            border: 1px solid var(--border);
        }

        .price-summary-card {
            background: var(--primary-gradient);
            padding: 30px;
            border-radius: 20px;
            text-align: center;
            color: #000;
            margin-top: 40px;
        }

        .total-price {
            font-size: 3rem;
            font-weight: 800;
        }

        @media (max-width: 768px) {
            .form-row {
                grid-template-columns: 1fr;
            }
        }
    </style>

    <script type="module">
        import AppState from '../../assets/js/state.js';
        import NavigationSystem from '../../assets/js/navigation.js';
        import FooterSystem from '../../assets/js/footer.js';

        document.addEventListener('DOMContentLoaded', () => {
            AppState.init();
            NavigationSystem.init(AppState.navigation.menuData);
            FooterSystem.init();
            loadSubjects();
        });
    </script>
</head>

<body>
    <header id="site-header"></header>
    <div id="site-breadcrumbs"></div>

    <main class="container">
        <section class="booking-hero">
            <h1
                style="font-size: 3.5rem; font-weight: 800; background: var(--primary-gradient); -webkit-background-clip: text; background-clip: text; -webkit-text-fill-color: transparent;">
                Guided Excellence</h1>
            <p style="color: #888; font-size: 1.2rem;">Secure your path to knowledge. Complete the form below to book
                your tuition sessions.</p>
        </section>

        <div class="booking-card glass-card animate-fade-up">
            <form id="tuition-booking-form">
                <div class="form-section">
                    <div class="form-section-title"><i class="ph-bold ph-user-focus"></i> Academic Identity</div>
                    <div class="form-row">
                        <div class="form-group">
                            <label class="form-label">First Name</label>
                            <input type="text" id="fname" class="form-input" placeholder="e.g. Ibrahim" required>
                        </div>
                        <div class="form-group">
                            <label class="form-label">Last Name</label>
                            <input type="text" id="lname" class="form-input" placeholder="e.g. Khalil" required>
                        </div>
                    </div>
                </div>

                <div class="form-section" style="margin-top: 40px;">
                    <div class="form-section-title"><i class="ph-bold ph-book-open-text"></i> Curriculum Selection</div>
                    <div class="checkbox-grid" id="subject-list">
                        <!-- Loaded dynamically -->
                    </div>
                </div>

                <div class="price-summary-card">
                    <h3>Investment Summary</h3>
                    <div class="total-price">₹<span id="final-total">0</span></div>
                </div>

                <button type="submit" class="btn btn-primary" style="width: 100%; margin-top: 40px; padding: 20px;">
                    Finalize Booking <i class="ph-bold ph-check"></i>
                </button>
            </form>
        </div>
    </main>

    <footer id="site-footer"></footer>

    <script src="../../assets/js/subject-storage.js"></script>
    <script>
        const bookingForm = document.getElementById('tuition-booking-form');
        const finalTotalDisplay = document.getElementById('final-total');
        const subjectListContainer = document.getElementById('subject-list');

        function calculateTotal() {
            let total = 0;
            const checkboxes = subjectListContainer.querySelectorAll('input[type="checkbox"]');
            checkboxes.forEach(cb => { if (cb.checked) total += Number(cb.dataset.price) || 0; });
            finalTotalDisplay.textContent = total.toLocaleString();
            return total;
        }

        subjectListContainer.addEventListener('change', (e) => {
            if (e.target.matches('input[type="checkbox"]')) calculateTotal();
        });

        function loadSubjects() {
            const subjects = SubjectStorage.getActive() || [];
            subjectListContainer.innerHTML = subjects.map(s => `
                <label class="checkbox-item" style="display: flex; align-items: center; gap: 10px; cursor: pointer;">
                    <input type="checkbox" value="${s.name}" data-price="${s.price}">
                    <span>${s.name} <small style="color: var(--primary-color);">₹${s.price}</small></span>
                </label>
            `).join('') || '<p>No subjects available.</p>';
        }

        bookingForm.addEventListener('submit', (e) => {
            e.preventDefault();
            alert("Booking submitted successfully (Simulated)");
            window.location.href = '../../index.html';
        });
    </script>
</body>

</html>