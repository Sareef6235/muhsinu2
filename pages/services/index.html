<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Services | MHMV</title>
    <link rel="stylesheet" href="../../assets/css/styles.css">
    <link rel="stylesheet" href="../../assets/css/animations.css">
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <script type="module" src="../../assets/js/components/header.js"></script>
    <script type="module" src="../../assets/js/services-cms.js"></script>
</head>

<body>
    <site-header></site-header>

    <main class="page-container" style="padding-top: 100px;">
        <div class="container">
            <h1 class="section-title">Our Services</h1>
            <p style="margin-bottom: 40px; color: #888;">Exploring our educational and community offerings.</p>

            <div id="services-wrapper" class="services-grid">
                <div class="loading-spinner"></div>
            </div>
        </div>
    </main>

    <script type="module">
        import { ServicesCMS } from '../../assets/js/services-cms.js';

        async function init() {
            const container = document.getElementById('services-wrapper');
            const params = new URLSearchParams(window.location.search);
            const id = params.get('id');

            if (id) {
                // Detail Mode
                const service = await ServicesCMS.getById(id);
                if (service) {
                    container.classList.remove('services-grid');
                    const content = service.content.en || service.content;
                    container.innerHTML = `
                         <a href="index.html" class="btn-text"><i class="ph ph-arrow-left"></i> Back to All Services</a>
                         <article class="service-detail animate-fade-up">
                            ${service.image ? `<img src="${service.image}" class="detail-hero-img">` : ''}
                            <div class="detail-header">
                                <i class="${service.icon} icon-large"></i>
                                <h2>${content.title}</h2>
                            </div>
                            <div class="detail-body">
                                ${content.full || content.shortDesc}
                            </div>
                         </article>
                    `;
                } else {
                    container.innerHTML = `<p>Service not found.</p>`;
                }
            } else {
                // List Mode
                const list = await ServicesCMS.getAll();
                const visible = list.filter(s => s.visible !== false);
                container.innerHTML = visible.map(s => {
                    const c = s.content.en || s.content;
                    return `
                        <div class="service-card animate-fade-up" onclick="window.location.href='?id=${s.id}'" style="cursor:pointer">
                            <i class="${s.icon} service-icon"></i>
                            <h3>${c.title}</h3>
                            <p>${c.shortDesc}</p>
                        </div>
                    `;
                }).join('');
            }
        }
        init();
    </script>

    <style>
        .icon-large {
            font-size: 3rem;
            color: var(--primary-color);
            margin-bottom: 15px;
        }

        .detail-hero-img {
            width: 100%;
            max-height: 400px;
            object-fit: cover;
            border-radius: 20px;
            margin-bottom: 30px;
        }

        .detail-body {
            font-size: 1.1rem;
            line-height: 1.8;
            color: #ccc;
        }
    </style>
</body>

</html>